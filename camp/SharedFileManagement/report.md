# 项目报告

## 待完成
* 前端中输入的正则
* 导出建表文件
* user添加phone
* 上传文件时，实现用户自己的多层目录

## 存在问题
* 文件在服务器中直接暴露给了用户
* 数据库的事务隔离,一些并发处理

## 遇到的问题和解决过程
* 问题：整合servlet时理解错误，以为BaseServlet是中转站，映射了BaseServlet，导致反射获取方法时找不到方法。
  * 解决方法：改为映射UserServlet，BaseServlet仅仅是用来继承的
* 问题：上传文件时后台报错 request 问题
  * 原因：无论是表单请求还是ajax请求上传文件时只能放一个formData，不能放别的参数
  * 解决方法：没找到放参数还能解析request的办法，只能另外开一个servlet映射来处理文件上传了。
* 问题：有时候上传一次文件后，再上传一次同文件没反应
  * 原因：同样的文件没触发onchange()
  * 解决方法：上传完一次后重置\<input>,然而出于安全考虑，浏览器只允许用户点击\<input type="file">来选择本地文件，
  用JavaScript对\<input type="file">的value赋值是没有任何效果的。
  所以先删再加回去。
* 问题：ajax请求赋值json不成功
  * 原因：实际上是成功的，但要注意异步通信，执行ajax之后的代码时，可能通信未完成，故变量仍未被赋值。
* 问题：ajax请求中，无论结果如何都进入error的函数。
  * 原因：
    1. 写了dataType:"json"，但后端传回的不是json或格式不规范
    2. 写了dataType:"json"，但后端的响应类型设置了其他如text/plain
  * 解决方法：
    1. 删掉dataType
    2. 检查后端响应类型application/json及响应内容

## 心得感想
* 前端元素的命名极其乱，要细读规范。且同一种目的用了多种方法实现（主要是对js不熟。。每次都相当于重新想）
* 每个模块做完了都要先测试一下。
* 做项目前先定好功能对应的接口
* 感觉越做越顺，虽然很累很痛苦，但我确实在做项目的过程中学习，不断进步，甚至连idea都用顺了很多。  
  前端内容让我最抓狂，但在这过程中我学会用F12调试，去学习别人网页的布局和设置再应用到自己身上，
  另外，我还积累了一个JQuery文档（小声bb：如果早有这东西我不用受那么多苦）。所以资源与经验都是积累出来的。  
  真是工欲善其事，必先利其器啊啊啊啊啊
* 开发过程磕磕绊绊，每做完一个模块都觉得：怎么这么简单的东西我做了这么久啊？！！！！！我觉得一方面的原因是，一些东西的用法不知道，比如fileupload库，比如jquery。  
  当我做完时，我可以肯定，再让我开发一个换汤不换药的东西，我会做的很快。
* 感觉自己效率好低，只好笨鸟先飞，多花点时间，日均打码10小时。。希望考核结束之后，我能继续完善这个项目。
## 依赖
* fastjson
* jdbc-mysql
* commons-fileupload
* commons-io


## 想请教的问题
* 产生的数据文件是放在webapps里好，还是限制在项目里好。
如果限制在项目里，tomcat更新war包时容易丢失数据呀。
* 好友列表和群组列表这种东西好像不适合放在数据库，所以我放外面了。
